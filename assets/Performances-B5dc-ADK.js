import{d as D,r as g,g as R,h as U,c as z,a as t,w as e,b as o,e as i,u as r,f as A,t as b,o as M,_ as B}from"./index-IoAneAfo.js";import{P as h}from"./constants-CeZz7UqS.js";import{f as G,t as j,a as q}from"./api-rjBpfQPZ.js";const H={class:"performances"},J=D({__name:"Performances",setup(K){const _=A(),y=g([]),f=g(!1),c=g(null),n=R({title:"",venue:"",status:""}),k=[{title:"演出ID",dataIndex:"id",width:100},{title:"演出标题",dataIndex:"title"},{title:"演出场馆",dataIndex:"venue"},{title:"状态",dataIndex:"status",slotName:"status"},{title:"操作",slotName:"actions"}],O=h,p=async()=>{f.value=!0;try{y.value=await G(n)}catch(s){console.error("加载演出数据失败:",s)}finally{f.value=!1}},C=()=>{p()},N=()=>{n.title="",n.venue="",n.status="",p()},w=async s=>{if(s.id){c.value=s.id;try{s.status==="OFFLINE"?await j(s.id):await q(s.id),await p()}catch(a){console.error("更新演出状态失败:",a)}finally{c.value=null}}};return U(()=>{p()}),(s,a)=>{const F=o("a-typography-title"),x=o("a-input"),m=o("a-form-item"),V=o("a-select"),u=o("a-button"),v=o("a-space"),S=o("a-form"),I=o("a-card"),E=o("icon-plus"),L=o("a-tag"),$=o("a-popconfirm"),P=o("a-table");return M(),z("div",H,[t(F,{heading:3,style:{"margin-top":"0px","margin-bottom":"24px"}},{default:e(()=>a[4]||(a[4]=[i("演出管理")])),_:1}),t(I,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(S,{model:n,layout:"inline"},{default:e(()=>[t(m,{field:"title",label:"演出标题"},{default:e(()=>[t(x,{modelValue:n.title,"onUpdate:modelValue":a[0]||(a[0]=l=>n.title=l),placeholder:"请输入演出标题","allow-clear":""},null,8,["modelValue"])]),_:1}),t(m,{field:"venue",label:"演出场馆"},{default:e(()=>[t(x,{modelValue:n.venue,"onUpdate:modelValue":a[1]||(a[1]=l=>n.venue=l),placeholder:"请输入场馆名称","allow-clear":""},null,8,["modelValue"])]),_:1}),t(m,{field:"status",label:"状态"},{default:e(()=>[t(V,{modelValue:n.status,"onUpdate:modelValue":a[2]||(a[2]=l=>n.status=l),options:r(O),placeholder:"请选择状态","allow-clear":""},null,8,["modelValue","options"])]),_:1}),t(m,null,{default:e(()=>[t(v,null,{default:e(()=>[t(u,{type:"primary",onClick:C},{default:e(()=>a[5]||(a[5]=[i("搜索")])),_:1}),t(u,{onClick:N},{default:e(()=>a[6]||(a[6]=[i("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(I,null,{title:e(()=>[t(v,null,{default:e(()=>[t(u,{type:"primary",onClick:a[3]||(a[3]=l=>r(_).push("/performances/create"))},{icon:e(()=>[t(E)]),default:e(()=>[a[7]||(a[7]=i(" 新建演出 "))]),_:1})]),_:1})]),default:e(()=>[t(P,{columns:k,data:y.value,pagination:{pageSize:10},loading:f.value},{status:e(({record:l})=>[t(L,{color:{ON_SALE:"green",COMING_SOON:"blue",SOLD_OUT:"red",OFFLINE:"orange"}[l.status]},{default:e(()=>{var d;return[i(b((d=r(O).find(T=>T.value===l.status))==null?void 0:d.label),1)]}),_:2},1032,["color"])]),actions:e(({record:l})=>[t(v,null,{default:e(()=>[t(u,{type:"text",size:"small",onClick:d=>r(_).push(`/performances/${l.id}/edit`)},{default:e(()=>a[8]||(a[8]=[i("编辑")])),_:2},1032,["onClick"]),t(u,{type:"text",size:"small",onClick:d=>r(_).push(`/performances/${l.id}/sessions`)},{default:e(()=>a[9]||(a[9]=[i("场次管理")])),_:2},1032,["onClick"]),t($,{content:`确认${l.status==="OFFLINE"?"上架":"下架"}该演出吗？`,onOk:d=>w(l)},{default:e(()=>[t(u,{type:"text",size:"small",status:"warning",loading:l.id===c.value},{default:e(()=>[i(b(l.status==="OFFLINE"?"上架":"下架"),1)]),_:2},1032,["loading"])]),_:2},1032,["content","onOk"])]),_:2},1024)]),_:1},8,["data","loading"])]),_:1})])}}}),Y=B(J,[["__scopeId","data-v-686e58d5"]]);export{Y as default};
