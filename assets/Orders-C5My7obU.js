import{a as I,b as h,g as V,f as H}from"./localStorage-DajKA7mC.js";import{d as J,r as f,g as K,q as Q,c as C,a as o,w as l,b as i,e as u,F as W,p as X,t as d,n as c,y as Y,z as Z,o as k,_ as ee}from"./index-DBWnnXR7.js";const te={class:"container"},ae={class:"text-gray-500 text-sm"},le={class:"text-gray-500 text-sm"},oe={class:"text-gray-500 text-sm"},ne=J({__name:"Orders",setup(se){const m=t=>{if(!t)return"-";const e=new Date(t);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).format(e)},v=f(!1),g=f([]),s=K({orderNo:"",status:"",time:[]}),S=[{label:"待支付",value:"pending"},{label:"已支付",value:"paid"},{label:"已取消",value:"cancelled"}],D=[{title:"订单编号",dataIndex:"orderNo",width:180},{title:"演出信息",slotName:"performance"},{title:"票档信息",slotName:"ticket"},{title:"订单金额",slotName:"amount",width:160},{title:"下单时间",dataIndex:"createTime",width:180,render:(t,e)=>m(e.createTime)},{title:"状态",slotName:"status",width:100},{title:"操作",slotName:"actions",width:160}],O=t=>{const e=I(t);return(e==null?void 0:e.title)||"-"},z=(t,e)=>{const n=h(t,e);return(n==null?void 0:n.title)||m((n==null?void 0:n.startShowTime)||"")},P=(t,e,n)=>{const r=V(t,e).find(p=>p.id===n);return(r==null?void 0:r.title)||"-"},A=t=>({pending:"orange",paid:"green",cancelled:"red"})[t]||"default",N=t=>({pending:"待支付",paid:"已支付",cancelled:"已取消"})[t]||t,b=()=>{var t,e;v.value=!0;try{g.value=H({orderNo:s.orderNo,status:s.status,startTime:(t=s.time)==null?void 0:t[0],endTime:(e=s.time)==null?void 0:e[1]})}finally{v.value=!1}},B=()=>{b()},F=()=>{s.orderNo="",s.status="",s.time=[],b()},y=f(!1),_=f(null),M=Q(()=>{if(!_.value)return[];const t=_.value,e=I(t.performanceId),n=h(t.performanceId,t.sessionId),r=V(t.performanceId,t.sessionId).find(p=>p.id===t.ticketId);return[{label:"订单编号",value:t.orderNo},{label:"下单时间",value:m(t.createTime)},{label:"支付时间",value:t.payTime?m(t.payTime):"-"},{label:"订单状态",value:N(t.status)},{label:"演出标题",value:(e==null?void 0:e.title)||"-"},{label:"场次信息",value:(n==null?void 0:n.title)||m((n==null?void 0:n.startShowTime)||"")},{label:"票档信息",value:(r==null?void 0:r.title)||"-"},{label:"票价",value:`¥${t.price}`},{label:"数量",value:t.quantity},{label:"票面总价",value:`¥${t.totalAmount}`},{label:"实付金额",value:`¥${t.finalAmount}`}]}),U=t=>{_.value=t,y.value=!0};return b(),(t,e)=>{const n=i("a-typography-title"),w=i("a-input"),r=i("a-form-item"),p=i("a-option"),$=i("a-select"),q=i("a-range-picker"),x=i("a-button"),T=i("a-space"),E=i("a-form"),L=i("a-tag"),R=i("a-table"),j=i("a-descriptions"),G=i("a-drawer");return k(),C("div",te,[o(n,{heading:3,style:{"margin-top":"0px","margin-bottom":"24px"}},{default:l(()=>e[4]||(e[4]=[u("订单管理")])),_:1}),o(E,{model:s,class:"filter-form",layout:"inline"},{default:l(()=>[o(r,{field:"orderNo",label:"订单编号"},{default:l(()=>[o(w,{modelValue:s.orderNo,"onUpdate:modelValue":e[0]||(e[0]=a=>s.orderNo=a),placeholder:"请输入订单编号","allow-clear":""},null,8,["modelValue"])]),_:1}),o(r,{field:"status",label:"订单状态"},{default:l(()=>[o($,{modelValue:s.status,"onUpdate:modelValue":e[1]||(e[1]=a=>s.status=a),placeholder:"请选择订单状态","allow-clear":""},{default:l(()=>[(k(),C(W,null,X(S,a=>o(p,{key:a.value,value:a.value},{default:l(()=>[u(d(a.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),o(r,{field:"time",label:"下单时间"},{default:l(()=>[o(q,{modelValue:s.time,"onUpdate:modelValue":e[2]||(e[2]=a=>s.time=a),style:{width:"260px"},"allow-clear":""},null,8,["modelValue"])]),_:1}),o(r,null,{default:l(()=>[o(T,null,{default:l(()=>[o(x,{type:"primary",onClick:B},{default:l(()=>e[5]||(e[5]=[u("搜索")])),_:1}),o(x,{onClick:F},{default:l(()=>e[6]||(e[6]=[u("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),o(R,{loading:v.value,data:g.value,columns:D,pagination:{total:g.value.length,pageSize:10,showTotal:!0,showPageSize:!0},class:"mt-4"},{performance:l(({record:a})=>[c("div",null,d(O(a.performanceId)),1),c("div",ae,d(z(a.performanceId,a.sessionId)),1)]),ticket:l(({record:a})=>[c("div",null,d(P(a.performanceId,a.sessionId,a.ticketId)),1),c("div",le,"¥"+d(a.price)+" × "+d(a.quantity),1)]),amount:l(({record:a})=>[c("div",null,"票面总价：¥"+d(a.totalAmount),1),c("div",oe,"实付金额：¥"+d(a.finalAmount),1)]),status:l(({record:a})=>[o(L,{color:A(a.status)},{default:l(()=>[u(d(N(a.status)),1)]),_:2},1032,["color"])]),actions:l(({record:a})=>[o(T,null,{default:l(()=>[o(x,{type:"text",size:"small",onClick:ie=>U(a)},{default:l(()=>e[7]||(e[7]=[u(" 查看 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["loading","data","pagination"]),o(G,{visible:y.value,"onUpdate:visible":e[3]||(e[3]=a=>y.value=a),width:600,title:"订单详情"},{default:l(()=>[_.value?(k(),Y(j,{key:0,data:M.value,layout:"inline-vertical",bordered:""},null,8,["data"])):Z("",!0)]),_:1},8,["visible"])])}}}),ue=ee(ne,[["__scopeId","data-v-779175b2"]]);export{ue as default};
